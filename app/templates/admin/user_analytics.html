<!DOCTYPE html>
<html>
<head>
  <title>User Analytics</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  {% include 'navbar.html' %}
  <div class="container py-5">
    <h2>User Analytics 📊</h2>

    <p><strong>Posts authored:</strong> {{ post_count }}</p>
    <p><strong>Comments made:</strong> {{ comment_count }}</p>

    <h5>Emoji Reactions Given</h5>
    <ul class="list-group">
      {% for emoji in ['❤️', '😂', '👍', '😢', '😡'] %}
        <li class="list-group-item d-flex justify-content-between">
          {{ emoji }} <span class="badge bg-primary">{{ emoji_totals.get(emoji, 0) }}</span>
        </li>
      {% endfor %}
    </ul>

    <a href="{{ url_for('admin.dashboard') }}" class="btn btn-secondary mt-4">Back to Dashboard</a>
  </div>


 <h5>Your Comments</h5>
<ul class="list-group">
  {% for comment in comments %}
    <li class="list-group-item">
      {{ comment.content }}
      <p class="text-muted small">Sentiment: {{ comment.sentiment() }}</p>
    </li>
  {% endfor %}
</ul>


<div class="card mt-4">
  <div class="card-header bg-info text-white">Crime Chart</div>
  <div class="card-body">
    <div id="crimeChart" style="height: 400px;"></div>
  </div>
</div>

<!-- Load Plotly.js -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>
  const labels = {{ chart_labels | safe }};
  const values = {{ chart_values | safe }};

  const data = [{
    type: 'pie',
    labels: labels,
    values: values,
    hole: 0.3,
    textinfo: 'label+percent',
    textposition: 'outside',
    automargin: true
  }];

  const layout = {
    title: 'Top 5 Crime Types in South Wales',
    height: 400,
    margin: { t: 40, b: 20, l: 20, r: 20 }
  };

  Plotly.newPlot('crimeChart', data, layout);
</script>



<!-- Footer -->
  <footer class="bg-dark text-white text-center py-3 mt-5">
    <p class="mb-0">© {{ current_year }} UK Crime Blog. Built by Hassan.</p>
  </footer>
</body>
</html>